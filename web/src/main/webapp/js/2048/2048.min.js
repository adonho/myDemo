(function(){function A(c,e){this.x=c;this.y=e}function y(){for(var b=0;b<m.length;b++)for(var e=0;e<m[b].length;e++)g===c[b][e]?m[b][e].setAttribute("class","c"):m[b][e].setAttribute("class","c"+c[b][e]),m[b][e].innerHTML=c[b][e]}function r(){if(i){var b=q[parseInt(Math.random()*n)],e=v();c[b.x][b.y]=e;y();1==n&&(s=B())&&alert("\u6e38\u620f\u7ed3\u675f")}}function B(){for(var b=0;b<k;b++)for(var e=0;e<j-1;e++)if(c[b][e]===c[b][e+1])return!1;for(e=0;e<j;e++)for(b=0;b<k-1;b++)if(c[b][e]===c[b+1][e])return!1;
return!0}function t(c,e){q[n++]=u[c][e]}function v(){return 2<<(parseInt(8*Math.random()+1)>>3)}var k=4,j=4,g="\u3000",q=Array(k*j),n=0,i,w=!1,x,s,c,u,m;window.onload=function(){x=document.createElement("div");document.body.appendChild(x);s=!1;c=[];u=[];m=[];for(var b=0;b<k;b++){c.push([]);m.push([]);u.push([]);for(var e=0;e<j;e++)c[b].push(g),m[b].push(g),u[b].push(new A(b,e))}for(var l=Math.min(window.innerHeight,window.innerWidth),b=l/12,l=l-b,b=b/j,l=l/j,p=b/2,q=l+b,b=0;b<m.length;b++)for(e=0;e<
m[b].length;e++){var z=document.createElement("span");x.appendChild(z);m[b][e]=z;m[b][e].setAttribute("style","position:absolute;top:"+(p+q*e)+"px;left:"+(p+q*b)+"px;width:"+l+"px;height:"+l+"px;")}for(l=0;l<c.length;l++)for(p=0;p<c[l].length;p++)c[l][p]=g;c[0][0]=v();c[1][0]=v();s=!1;y();window.onkeydown=function(d){if(!s&&!w){w=!0;try{switch(d.keyCode){case 37:n=0;i=!1;for(d=0;d<j;d++){for(var b=0,f=0,e=!1,h=!1,a=0;a<k;a++)c[a][d]===g?0==a?(b=a,e=!0):e||(b=a,e=!0):0==a?(f=a,h=!0):h?c[f][d]==c[a][d]?
(c[f][d]<<=1,c[a][d]=g,h=!1,i=!0,e||(b=a,e=!0)):e?(c[b][d]=c[a][d],c[a][d]=g,i=!0,f=b,b++):f=a:(e?(c[b][d]=c[a][d],c[a][d]=g,i=!0,f=b,b++):f=a,h=!0);for(a=0;a<k;a++)c[a][d]===g&&t(a,d)}r();break;case 38:n=0;i=!1;for(d=0;d<k;d++){f=b=0;h=e=!1;for(a=0;a<j;a++)c[d][a]===g?0===a?(b=a,e=!0):e||(b=a,e=!0):0===a?(f=a,h=!0):h?c[d][f]==c[d][a]?(c[d][f]<<=1,c[d][a]=g,h=!1,i=!0,e||(b=a,e=!0)):e?(c[d][b]=c[d][a],c[d][a]=g,i=!0,f=b,b++):f=a:(e?(c[d][b]=c[d][a],c[d][a]=g,i=!0,f=b,b++):f=a,h=!0);for(a=0;a<j;a++)c[d][a]===
g&&t(d,a)}r();break;case 39:n=0;i=!1;for(d=0;d<j;d++){b=k-1;f=k-1;h=e=!1;for(a=k-1;0<=a;a--)c[a][d]===g?a===k-1?(b=a,e=!0):e||(b=a,e=!0):a===k-1?(f=a,h=!0):h?c[f][d]==c[a][d]?(c[f][d]<<=1,c[a][d]=g,h=!1,i=!0,e||(b=a,e=!0)):e?(c[b][d]=c[a][d],c[a][d]=g,i=!0,f=b,b--):f=a:(e?(c[b][d]=c[a][d],c[a][d]=g,i=!0,f=b,b--):f=a,h=!0);for(a=0;a<k;a++)c[a][d]===g&&t(a,d)}r();break;case 40:n=0;i=!1;for(d=0;d<j;d++){b=j-1;f=j-1;h=e=!1;for(a=j-1;0<=a;a--)c[d][a]===g?a===j-1?(b=a,e=!0):e||(b=a,e=!0):a===j-1?(f=a,h=
!0):h?c[d][f]==c[d][a]?(c[d][f]<<=1,c[d][a]=g,h=!1,i=!0,e||(b=a,e=!0)):e?(c[d][b]=c[d][a],c[d][a]=g,i=!0,f=b,b--):f=a:(e?(c[d][b]=c[d][a],c[d][a]=g,i=!0,f=b,b--):f=a,h=!0);for(a=0;a<j;a++)c[d][a]===g&&t(d,a)}r();break}}finally{w=!1}}}}})();
